import "signatures\verifyEddsa" as verifyEddsa;
from "ecc/babyjubjubParams" import BABYJUBJUB_PARAMS;

def verify<N>(field[2] R, field S, field[2] A, u8[N] M) -> bool{
    u32[8] M0 = sha256(M);
    u32[8] M1 = [0,0, 0,0 ,0,0, 0,0];
    bool isVerified = verifyEddsa(R,S,A,M0,M1,BABYJUBJUB_PARAMS);
    assert(isVerified);
    return;
}

def main(field[2] R, field S, field[2] A, u8[565] M) -> bool{
    assert(verify<565>(R,S,A,M))
}