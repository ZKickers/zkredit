import "hashes/sha256/sha256Padded" as sha256;
from "./concat.zok" import clientConcat;
from "./interface" import ClientData;

def main<N_name,N_adr,N_bd,N_ssn>(
    ClientData<N_name,N_adr,N_bd,N_ssn> clientData,
    u8[32] nonce) -> u32[8]{
        u32 N = N_name + N_adr + N_bd + N_ssn;
        u8[N] clientDataConc = clientConcat(clientData);
        u8[N+32] inputWithNonce = [...clientDataConc,...nonce];
        u32[8] h = sha256(inputWithNonce);
        return h;
}
